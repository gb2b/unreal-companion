# P2.9 Document Desk (Bureau Virtuel)

## Objectif

Cr√©er un espace de gestion et visualisation des documents du projet avec navigation par dossiers, √©dition WYSIWYG, et int√©gration chat pour approfondir le contenu.

## Pr√©requis

- [x] P1.2 - Structure projet avec artifacts/
- [x] P2.4 - Workflows (pour suggestions)
- [ ] P2.8 - Party Mode lite (pour suggestions)

## Concept

Un "bureau virtuel" dans Studio o√π l'utilisateur peut :
- Naviguer dans ses documents par cat√©gorie/dossier
- Visualiser et √©diter les documents (WYSIWYG ‚Üí .md)
- Ouvrir un chat contextuel √† c√¥t√© d'un document
- S√©lectionner du contenu pour l'ajouter au contexte chat
- Recevoir des suggestions de workflows/party mode pour approfondir

## Fichiers √† Cr√©er

### Backend

- `web-ui/server/api/documents.py` ‚Äî Routes CRUD documents
- `web-ui/server/services/document_service.py` ‚Äî Gestion documents

### Frontend

- `web-ui/src/pages/DocumentDeskPage.tsx` ‚Äî Page principale
- `web-ui/src/components/documents/DocumentBrowser.tsx` ‚Äî Navigation dossiers
- `web-ui/src/components/documents/DocumentViewer.tsx` ‚Äî Visualisation
- `web-ui/src/components/documents/DocumentEditor.tsx` ‚Äî √âdition WYSIWYG
- `web-ui/src/components/documents/DocumentChat.tsx` ‚Äî Chat contextuel
- `web-ui/src/components/documents/DocumentSuggestions.tsx` ‚Äî Suggestions LLM
- `web-ui/src/stores/documentStore.ts` ‚Äî √âtat documents

## Sp√©cifications

### Structure des Dossiers

```
artifacts/
‚îú‚îÄ‚îÄ briefs/              # Game Brief, Quick Brief
‚îú‚îÄ‚îÄ design/              # GDD, Technical Design, Level Design
‚îú‚îÄ‚îÄ narrative/           # Narrative Bible, Character Sheets
‚îú‚îÄ‚îÄ art/                 # Art Bible, Style Guide
‚îú‚îÄ‚îÄ audio/               # Audio Design
‚îú‚îÄ‚îÄ sessions/            # Brainstorms, Party Mode transcripts
‚îú‚îÄ‚îÄ boards/              # Mood boards, Mind maps (JSON)
‚îú‚îÄ‚îÄ reports/             # Sprint reports, Progress
‚îî‚îÄ‚îÄ references/          # Asset lists, External refs
```

### Types de Documents

| Cat√©gorie | Type | Format | Ic√¥ne |
|-----------|------|--------|-------|
| **Briefs** | Game Brief | `.md` | üìÑ |
| | Quick Brief | `.md` | üìÑ |
| **Design** | GDD | `.md` | üìò |
| | Technical Design | `.md` | ‚öôÔ∏è |
| | Level Design | `.md` | üó∫Ô∏è |
| **Narrative** | Narrative Bible | `.md` | üìñ |
| | Character Sheet | `.md` | üë§ |
| **Art** | Art Bible | `.md` | üé® |
| | Style Guide | `.md` | üñåÔ∏è |
| **Audio** | Audio Design | `.md` | üéµ |
| **Sessions** | Brainstorm | `.md` | üí≠ |
| | Party Mode | `.md` | üéâ |
| **Boards** | Mood Board | `.json` | üñºÔ∏è |
| | Mind Map | `.json` | üó∫Ô∏è |
| | Flowchart | `.json` | üìä |
| **Reports** | Sprint Report | `.md` | üìà |
| | Progress | `.md` | ‚úÖ |
| **References** | Asset List | `.md` | üì¶ |
| | External Refs | `.md` | üîó |

### UI Navigation

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  üìÅ Documents                           [Rechercher...]  [Vue: Grille ‚ñæ]   ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                                             ‚îÇ
‚îÇ  Cat√©gories:                                                                ‚îÇ
‚îÇ  [Tous] [Briefs] [Design] [Narrative] [Art] [Sessions] [Boards] [Reports]  ‚îÇ
‚îÇ                                                                             ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê            ‚îÇ
‚îÇ  ‚îÇ üìÑ         ‚îÇ  ‚îÇ üìò         ‚îÇ  ‚îÇ üìñ         ‚îÇ  ‚îÇ üí≠         ‚îÇ            ‚îÇ
‚îÇ  ‚îÇ            ‚îÇ  ‚îÇ            ‚îÇ  ‚îÇ            ‚îÇ  ‚îÇ            ‚îÇ            ‚îÇ
‚îÇ  ‚îÇ game-brief ‚îÇ  ‚îÇ gdd        ‚îÇ  ‚îÇ narrative  ‚îÇ  ‚îÇ brainstorm ‚îÇ            ‚îÇ
‚îÇ  ‚îÇ Modifi√©:   ‚îÇ  ‚îÇ Modifi√©:   ‚îÇ  ‚îÇ Modifi√©:   ‚îÇ  ‚îÇ Modifi√©:   ‚îÇ            ‚îÇ
‚îÇ  ‚îÇ il y a 2h  ‚îÇ  ‚îÇ hier       ‚îÇ  ‚îÇ il y a 3j  ‚îÇ  ‚îÇ il y a 1h  ‚îÇ            ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò            ‚îÇ
‚îÇ                                                                             ‚îÇ
‚îÇ  [+ Nouveau document]  [üì• Importer]                                        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### Mode Visualisation + Chat

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  üìÑ game-brief.md        [‚úèÔ∏è] [‚úï]     ‚îÇ  üí¨ Chat avec Maya                 ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§  (Game Designer)                   ‚îÇ
‚îÇ                                        ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  # The Last Shard - Game Brief         ‚îÇ                                    ‚îÇ
‚îÇ                                        ‚îÇ  Maya: Je vois ton brief !         ‚îÇ
‚îÇ  ## Vision                             ‚îÇ  La section "Core Loop" pourrait   ‚îÇ
‚îÇ  > Explorer un monde fig√©...           ‚îÇ  √™tre d√©velopp√©e.                  ‚îÇ
‚îÇ                                        ‚îÇ                                    ‚îÇ
‚îÇ  ## Genre                              ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  - Primary: Exploration                ‚îÇ  ‚îÇ üöÄ Suggestions               ‚îÇ  ‚îÇ
‚îÇ  - References: Outer Wilds...          ‚îÇ  ‚îÇ                              ‚îÇ  ‚îÇ
‚îÇ                                        ‚îÇ  ‚îÇ [Workflow: Approfondir       ‚îÇ  ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îÇ  ‚îÇ  les m√©caniques]             ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ üìé Section s√©lectionn√©e:     ‚îÇ      ‚îÇ  ‚îÇ                              ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ "## Core Loop"               ‚îÇ      ‚îÇ  ‚îÇ [Party Mode: D√©battre        ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ [+ Ajouter au contexte]      ‚îÇ      ‚îÇ  ‚îÇ  avec l'Architecte]          ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îÇ                                        ‚îÇ                                    ‚îÇ
‚îÇ                                        ‚îÇ  [________________] [Envoyer]      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### Mode √âdition WYSIWYG

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  üìÑ game-brief.md                      [üëÅÔ∏è Preview] [üíæ Sauvegarder] [‚úï]   ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  [B] [I] [H1] [H2] [H3] [‚Ä¢] [1.] ["] [üîó] [üì∑] [---]                       ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                                             ‚îÇ
‚îÇ  # The Last Shard - Game Brief                                              ‚îÇ
‚îÇ                                                                             ‚îÇ
‚îÇ  ## Vision                                                                  ‚îÇ
‚îÇ                                                                             ‚îÇ
‚îÇ  > Explorer un monde fig√© dans le temps pour d√©couvrir                     ‚îÇ
‚îÇ  > les secrets d'une civilisation oubli√©e.                                 ‚îÇ
‚îÇ                                                                             ‚îÇ
‚îÇ  ## Genre                                                                   ‚îÇ
‚îÇ                                                                             ‚îÇ
‚îÇ  - **Primary**: Exploration                                                 ‚îÇ
‚îÇ  - **Secondary**: Puzzle, Narrative                                         ‚îÇ
‚îÇ  - **References**: Outer Wilds, Chants of Sennaar                          ‚îÇ
‚îÇ                                                                             ‚îÇ
‚îÇ  ## Core Loop                                                               ‚îÇ
‚îÇ                                                                             ‚îÇ
‚îÇ  |                                                                          ‚îÇ
‚îÇ                                                                             ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  ‚úÖ Auto-save activ√© ‚Ä¢ Derni√®re sauvegarde: il y a 30s                      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### Suggestions LLM

Le LLM analyse le document ouvert et propose :

```typescript
interface DocumentSuggestion {
  type: 'workflow' | 'party_mode' | 'action';
  id: string;
  label: string;
  description: string;
  context: {
    section?: string;      // Section du document concern√©e
    reason: string;        // Pourquoi cette suggestion
  };
}

// Exemples de suggestions
const suggestions: DocumentSuggestion[] = [
  {
    type: 'workflow',
    id: 'mechanics-deep-dive',
    label: 'Approfondir les m√©caniques',
    description: 'Workflow pour d√©tailler le core loop',
    context: {
      section: 'Core Loop',
      reason: 'Cette section semble incompl√®te'
    }
  },
  {
    type: 'party_mode',
    id: 'debate-progression',
    label: 'D√©bat: Progression lin√©aire vs ouverte',
    description: 'Discussion Designer + Architecte',
    context: {
      section: 'Progression',
      reason: 'Point de design √† valider'
    }
  },
  {
    type: 'action',
    id: 'generate-character-sheet',
    label: 'Cr√©er fiche personnage',
    description: 'G√©n√©rer un template de Character Sheet',
    context: {
      reason: 'Aucune fiche personnage d√©tect√©e'
    }
  }
];
```

### API Routes

```python
# GET /api/documents
# Liste tous les documents avec m√©tadonn√©es

# GET /api/documents/{path}
# R√©cup√®re le contenu d'un document

# PUT /api/documents/{path}
# Sauvegarde un document

# POST /api/documents
# Cr√©e un nouveau document
# Body: { path, content, type }

# DELETE /api/documents/{path}
# Supprime un document

# POST /api/documents/{path}/suggestions
# G√©n√®re des suggestions LLM pour le document
```

### Store Zustand

```typescript
interface DocumentStore {
  // Navigation
  currentPath: string | null;
  documents: DocumentMeta[];
  folders: string[];

  // Document ouvert
  openDocument: Document | null;
  isEditing: boolean;
  hasUnsavedChanges: boolean;

  // Chat contextuel
  chatOpen: boolean;
  selectedContext: string | null;

  // Suggestions
  suggestions: DocumentSuggestion[];

  // Actions
  loadDocuments: () => Promise<void>;
  openDocument: (path: string) => Promise<void>;
  saveDocument: (content: string) => Promise<void>;
  createDocument: (type: string, name: string) => Promise<void>;
  deleteDocument: (path: string) => Promise<void>;

  toggleEdit: () => void;
  toggleChat: () => void;
  setSelectedContext: (text: string | null) => void;

  loadSuggestions: () => Promise<void>;
  executeSuggestion: (suggestion: DocumentSuggestion) => void;
}
```

### Int√©gration WYSIWYG

Utiliser une librairie existante pour l'√©dition :

```typescript
// Options recommand√©es (ordre de pr√©f√©rence)
// 1. TipTap (bas√© sur ProseMirror) - flexible, extensible
// 2. Milkdown (bas√© sur ProseMirror) - focus markdown
// 3. react-markdown-editor-lite - simple

// Configuration TipTap pour markdown
import { useEditor } from '@tiptap/react'
import StarterKit from '@tiptap/starter-kit'
import Markdown from 'tiptap-markdown'

const editor = useEditor({
  extensions: [
    StarterKit,
    Markdown.configure({
      transformPastedText: true,
      transformCopiedText: true,
    }),
  ],
  content: markdownContent,
  onUpdate: ({ editor }) => {
    const markdown = editor.storage.markdown.getMarkdown()
    setContent(markdown)
  },
})
```

## Crit√®res d'Acceptation

### Navigation

- [ ] Liste des documents par cat√©gorie
- [ ] Vue grille et liste
- [ ] Recherche dans les documents
- [ ] Cr√©ation de nouveau document
- [ ] Import de document externe

### Visualisation

- [ ] Rendu markdown propre
- [ ] S√©lection de texte pour contexte
- [ ] Chat contextuel √† c√¥t√©
- [ ] Suggestions LLM pertinentes

### √âdition

- [ ] WYSIWYG avec toolbar
- [ ] Auto-save
- [ ] Preview markdown
- [ ] Sauvegarde en .md

### Suggestions

- [ ] Propositions de workflows pertinents
- [ ] Propositions de party mode
- [ ] Actions contextuelles (cr√©er doc li√©, etc.)

## Tests √† √âcrire

### Unit Tests

```typescript
describe('DocumentBrowser', () => {
  it('should list documents by category');
  it('should filter by search term');
  it('should switch between grid and list view');
});

describe('DocumentEditor', () => {
  it('should render markdown as WYSIWYG');
  it('should save as markdown');
  it('should auto-save after delay');
  it('should show unsaved changes indicator');
});

describe('DocumentSuggestions', () => {
  it('should generate workflow suggestions');
  it('should generate party mode suggestions');
  it('should execute suggestion and navigate');
});
```

### Integration Tests

```python
def test_document_crud():
    # Create, read, update, delete document

def test_document_suggestions():
    # Verify LLM generates relevant suggestions

def test_document_search():
    # Search across all documents
```

## Notes

- Les documents JSON (boards) ont leur propre viewer/editor (voir P2.2)
- Le chat contextuel utilise le m√™me syst√®me que le chat principal
- Les suggestions sont g√©n√©r√©es √† l'ouverture du document (lazy)
- Auto-save toutes les 30s si modifications
- Historique de versions optionnel (nice-to-have)
